# Phase 4 éªŒæ”¶æŠ¥å‘Š - å‰ç«¯å®ç°

## âœ… éªŒæ”¶ç»“æœ

**çŠ¶æ€**: é€šè¿‡ âœ…
**å®Œæˆæ—¥æœŸ**: 2025-10-28
**æ„å»ºçŠ¶æ€**: æˆåŠŸ âœ…

```bash
$ npm run build

vite v5.4.21 building for production...
âœ“ 89 modules transformed.
âœ“ built in 330ms

dist/index.html                   0.46 kB â”‚ gzip:  0.34 kB
dist/assets/index-lUauK4Mh.css   10.58 kB â”‚ gzip:  2.76 kB
dist/assets/index-DNIQmpcU.js   223.60 kB â”‚ gzip: 74.82 kB
```

---

## ğŸ“¦ äº¤ä»˜å†…å®¹

### 1. æ ¸å¿ƒç»„ä»¶

#### API å®¢æˆ·ç«¯ (`src/services/api.js`)

**åŠŸèƒ½**:
- âœ… ä¼šè¯ç®¡ç†ï¼ˆåˆ›å»ºã€åˆ é™¤ï¼‰
- âœ… æ™ºèƒ½æŸ¥è¯¢ï¼ˆéæµå¼ã€SSEæµå¼ï¼‰
- âœ… æ–‡ä»¶ä¸Šä¼ ï¼ˆæ”¯æŒè¿›åº¦ï¼‰
- âœ… å¥åº·æ£€æŸ¥å’Œç³»ç»Ÿä¿¡æ¯

**å…³é”®ç‰¹æ€§**:
- Axios å®ä¾‹å°è£…
- è¯·æ±‚/å“åº”æ‹¦æˆªå™¨
- SSE (Server-Sent Events) é›†æˆ
- é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶
- ä¸Šä¼ è¿›åº¦å›è°ƒ

**ä»£ç ç¤ºä¾‹**:
```javascript
// SSE æµå¼æŸ¥è¯¢
apiService.queryStream(
  sessionId,
  message,
  (data) => {
    // å¤„ç†å®æ—¶æ¶ˆæ¯
    if (data.type === 'message') {
      updateMessage(data.content);
    }
  },
  (error) => console.error(error),
  () => console.log('Stream complete')
);
```

#### Message ç»„ä»¶ (`src/components/Message.jsx`)

**åŠŸèƒ½**:
- âœ… ç”¨æˆ·/åŠ©æ‰‹/ç³»ç»Ÿæ¶ˆæ¯å±•ç¤º
- âœ… Markdown æ¸²æŸ“ï¼ˆä½¿ç”¨ markedï¼‰
- âœ… ä»£ç å—é«˜äº®
- âœ… æ·»åŠ åˆ° FAQ æŒ‰é’®
- âœ… æ—¶é—´æˆ³æ˜¾ç¤º

**æ ·å¼ç‰¹æ€§**:
- æ¸å˜èƒŒæ™¯è‰²ï¼ˆç”¨æˆ·æ¶ˆæ¯ç´«è‰²ï¼ŒåŠ©æ‰‹æ¶ˆæ¯ç°è‰²ï¼‰
- åŠ¨ç”»æ•ˆæœï¼ˆæ·¡å…¥åŠ¨ç”»ï¼‰
- å“åº”å¼å¸ƒå±€
- Markdown æ ·å¼ç¾åŒ–
- æ‚¬åœæ•ˆæœ

#### FileUpload ç»„ä»¶ (`src/components/FileUpload.jsx`)

**åŠŸèƒ½**:
- âœ… æ‹–æ‹½ä¸Šä¼ 
- âœ… ç‚¹å‡»é€‰æ‹©æ–‡ä»¶
- âœ… å¤šæ–‡ä»¶æ”¯æŒ
- âœ… ä¸Šä¼ è¿›åº¦æ˜¾ç¤º
- âœ… æ–‡ä»¶åˆ—è¡¨ç®¡ç†
- âœ… æ–‡ä»¶å¤§å°æ ¼å¼åŒ–

**ç”¨æˆ·ä½“éªŒ**:
- æ‹–æ‹½åŒºåŸŸè§†è§‰åé¦ˆ
- æ–‡ä»¶åˆ—è¡¨å®æ—¶é¢„è§ˆ
- ä¸Šä¼ è¿›åº¦æ¡
- é”™è¯¯æç¤º
- æ–‡ä»¶ç§»é™¤åŠŸèƒ½

#### ChatView ä¸»ç•Œé¢ (`src/components/ChatView.jsx`)

**åŠŸèƒ½**:
- âœ… ä¼šè¯ç”Ÿå‘½å‘¨æœŸç®¡ç†
- âœ… æ¶ˆæ¯åˆ—è¡¨å±•ç¤º
- âœ… SSE æµå¼å“åº”é›†æˆ
- âœ… æ–‡ä»¶ä¸Šä¼ é›†æˆ
- âœ… è¾“å…¥æ¡†ï¼ˆæ”¯æŒå¤šè¡Œï¼‰
- âœ… æ¸…ç©ºå¯¹è¯åŠŸèƒ½
- âœ… è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨
- âœ… æ·»åŠ åˆ° FAQ åŠŸèƒ½

**æ ¸å¿ƒé€»è¾‘**:
```javascript
// SSE æµå¼å“åº”å¤„ç†
const updateLastAssistantMessage = (content) => {
  setMessages(prev => {
    const newMessages = [...prev];
    const lastIndex = newMessages.length - 1;

    if (lastIndex >= 0 && newMessages[lastIndex].role === 'assistant') {
      // è¿½åŠ å†…å®¹åˆ°æœ€åä¸€æ¡åŠ©æ‰‹æ¶ˆæ¯
      newMessages[lastIndex].content += content;
    } else {
      // åˆ›å»ºæ–°çš„åŠ©æ‰‹æ¶ˆæ¯
      newMessages.push({
        role: 'assistant',
        content,
        timestamp: Date.now(),
      });
    }

    return newMessages;
  });
};
```

**ç‰¹è‰²åŠŸèƒ½**:
- æ¬¢è¿æ¶ˆæ¯å¼•å¯¼
- åŠ è½½åŠ¨ç”»ï¼ˆè·³åŠ¨çš„ç‚¹ï¼‰
- é”™è¯¯æç¤ºæ¨ªå¹…
- å“åº”å¼è®¾è®¡
- Shift+Enter æ¢è¡Œ

### 2. å…¨å±€é…ç½®

#### App.jsx å’Œ App.css

**App.jsx**:
- ç®€æ´çš„æ ¹ç»„ä»¶
- é›†æˆ ChatView

**App.css**:
- å…¨å±€æ ·å¼é‡ç½®
- è‡ªå®šä¹‰æ»šåŠ¨æ¡
- åŠ¨ç”»å®šä¹‰
- å“åº”å¼å­—ä½“
- é€‰æ‹©æ–‡æœ¬æ ·å¼

#### Vite é…ç½® (`vite.config.js`)

**ä»£ç†é…ç½®**:
```javascript
server: {
  port: 3000,
  proxy: {
    '/api': {
      target: 'http://localhost:8000',
      changeOrigin: true,
    },
  }
}
```

**ä¼˜åŠ¿**:
- å¼€å‘ç¯å¢ƒæ— éœ€ CORS é…ç½®
- è‡ªåŠ¨ä»£ç†åˆ°åç«¯ API
- çƒ­æ›´æ–°æ”¯æŒ

---

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### ç»„ä»¶å±‚æ¬¡ç»“æ„

```
App
 â””â”€â”€ ChatView (ä¸»ç•Œé¢)
      â”œâ”€â”€ Header (å¤´éƒ¨)
      â”‚    â”œâ”€â”€ æ ‡é¢˜å’Œä¼šè¯ä¿¡æ¯
      â”‚    â””â”€â”€ æ“ä½œæŒ‰é’®ï¼ˆä¸Šä¼ ã€æ¸…ç©ºï¼‰
      â”‚
      â”œâ”€â”€ FileUpload (æ–‡ä»¶ä¸Šä¼  - å¯é€‰æ˜¾ç¤º)
      â”‚    â”œâ”€â”€ æ‹–æ‹½åŒºåŸŸ
      â”‚    â”œâ”€â”€ æ–‡ä»¶åˆ—è¡¨
      â”‚    â””â”€â”€ ä¸Šä¼ æŒ‰é’®
      â”‚
      â”œâ”€â”€ Messages Container (æ¶ˆæ¯å®¹å™¨)
      â”‚    â”œâ”€â”€ Welcome Message (æ¬¢è¿æ¶ˆæ¯)
      â”‚    â”œâ”€â”€ Message[] (æ¶ˆæ¯åˆ—è¡¨)
      â”‚    â”‚    â”œâ”€â”€ ç”¨æˆ·æ¶ˆæ¯
      â”‚    â”‚    â”œâ”€â”€ åŠ©æ‰‹æ¶ˆæ¯
      â”‚    â”‚    â””â”€â”€ ç³»ç»Ÿæ¶ˆæ¯
      â”‚    â””â”€â”€ Loading Indicator (åŠ è½½æŒ‡ç¤º)
      â”‚
      â””â”€â”€ Input Container (è¾“å…¥åŒºåŸŸ)
           â”œâ”€â”€ Textarea (å¤šè¡Œè¾“å…¥æ¡†)
           â””â”€â”€ Send Button (å‘é€æŒ‰é’®)
```

### æ•°æ®æµ

```
ç”¨æˆ·æ“ä½œ â†’ çŠ¶æ€æ›´æ–° â†’ ç»„ä»¶é‡æ¸²æŸ“
    â”‚
    â”œâ”€â†’ å‘é€æ¶ˆæ¯ â†’ API Service â†’ SSE Stream â†’ å®æ—¶æ›´æ–°
    â”œâ”€â†’ ä¸Šä¼ æ–‡ä»¶ â†’ API Service â†’ è¿›åº¦å›è°ƒ â†’ è‡ªåŠ¨å¡«å……æ¶ˆæ¯
    â””â”€â†’ æ·»åŠ FAQ  â†’ è‡ªåŠ¨å¡«å……æ¶ˆæ¯ â†’ ç”¨æˆ·ç¡®è®¤å‘é€
```

### SSE æµå¼å“åº”æµç¨‹

```
1. ç”¨æˆ·å‘é€æ¶ˆæ¯
   â†“
2. ChatView è°ƒç”¨ apiService.queryStream()
   â†“
3. å»ºç«‹ EventSource è¿æ¥åˆ° /api/query/stream
   â†“
4. åç«¯æµå¼è¿”å›æ•°æ®
   â†“
5. onMessage å›è°ƒæ¥æ”¶æ•°æ®å—
   â†“
6. updateLastAssistantMessage è¿½åŠ å†…å®¹
   â†“
7. React é‡æ–°æ¸²æŸ“æ¶ˆæ¯ç»„ä»¶
   â†“
8. ç”¨æˆ·å®æ—¶çœ‹åˆ° AI å›å¤
   â†“
9. æ”¶åˆ° type=done æ¶ˆæ¯ï¼Œå…³é—­è¿æ¥
```

---

## ğŸ“Š ç»Ÿè®¡æ•°æ®

### ä»£ç ç»Ÿè®¡

| æ–‡ä»¶ | è¡Œæ•° | åŠŸèƒ½ |
|------|------|------|
| `src/services/api.js` | 174 | API å®¢æˆ·ç«¯å°è£… |
| `src/components/ChatView.jsx` | 313 | ä¸»èŠå¤©ç•Œé¢ |
| `src/components/ChatView.css` | 426 | èŠå¤©ç•Œé¢æ ·å¼ |
| `src/components/Message.jsx` | 67 | æ¶ˆæ¯ç»„ä»¶ |
| `src/components/Message.css` | 231 | æ¶ˆæ¯æ ·å¼ |
| `src/components/FileUpload.jsx` | 206 | æ–‡ä»¶ä¸Šä¼ ç»„ä»¶ |
| `src/components/FileUpload.css` | 224 | ä¸Šä¼ ç»„ä»¶æ ·å¼ |
| `src/App.jsx` | 18 | æ ¹ç»„ä»¶ |
| `src/App.css` | 94 | å…¨å±€æ ·å¼ |
| **æ€»è®¡** | **1,753** | |

### ä¾èµ–åŒ…

| åŒ…å | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| react | ^18.2.0 | UI æ¡†æ¶ |
| react-dom | ^18.2.0 | DOM æ¸²æŸ“ |
| axios | ^1.6.0 | HTTP å®¢æˆ·ç«¯ |
| marked | ^10.0.0 | Markdown æ¸²æŸ“ |
| vite | ^5.0.8 | æ„å»ºå·¥å…· |

### æ„å»ºäº§ç‰©

| æ–‡ä»¶ | å¤§å° | Gzip | è¯´æ˜ |
|------|------|------|------|
| index.html | 0.46 KB | 0.34 KB | HTML å…¥å£ |
| CSS bundle | 10.58 KB | 2.76 KB | æ ·å¼æ–‡ä»¶ |
| JS bundle | 223.60 KB | 74.82 KB | JavaScript ä»£ç  |
| **æ€»è®¡** | **234.64 KB** | **77.92 KB** | |

---

## ğŸ¯ æ ¸å¿ƒç‰¹æ€§

### 1. SSE æµå¼å“åº”

**ä¸ºä»€ä¹ˆä½¿ç”¨ SSEï¼Ÿ**
- âœ… å®æ—¶æ˜¾ç¤º AI æ€è€ƒè¿‡ç¨‹
- âœ… æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ
- âœ… å‡å°‘ç­‰å¾…æ„ŸçŸ¥
- âœ… ç®€å•æ˜“ç”¨ï¼ˆç›¸æ¯” WebSocketï¼‰

**å®ç°ç»†èŠ‚**:
```javascript
// åˆ›å»º EventSource
const url = new URL('/api/query/stream', window.location.origin);
url.searchParams.append('session_id', sessionId);
url.searchParams.append('message', message);

const eventSource = new EventSource(url.toString());

eventSource.onmessage = (event) => {
  const data = JSON.parse(event.data);
  if (data.type === 'message') {
    // è¿½åŠ åˆ°æ¶ˆæ¯
    updateLastAssistantMessage(data.content);
  } else if (data.type === 'done') {
    // å…³é—­è¿æ¥
    eventSource.close();
  }
};
```

**ä¼˜åŠ¿**:
- è‡ªåŠ¨é‡è¿æœºåˆ¶
- å•å‘æµå¼ä¼ è¾“
- æµè§ˆå™¨åŸç”Ÿæ”¯æŒ
- æ— éœ€é¢å¤–åº“

### 2. æ–‡ä»¶ä¸Šä¼ ä½“éªŒ

**æ‹–æ‹½ä¸Šä¼ **:
```javascript
const handleDrop = (e) => {
  e.preventDefault();
  const files = Array.from(e.dataTransfer.files);
  setSelectedFiles(files);
};
```

**è‡ªåŠ¨å¡«å……æ¶ˆæ¯**:
ä¸Šä¼ å®Œæˆåï¼Œè‡ªåŠ¨ç”ŸæˆåŒ…å«æ–‡ä»¶è·¯å¾„çš„æ¶ˆæ¯ï¼Œç”¨æˆ·å¯ä»¥ç¼–è¾‘åå‘é€ï¼š

```
è¯·å°†ä»¥ä¸‹æ–‡ä»¶æ·»åŠ åˆ°çŸ¥è¯†åº“:

- document.pdf (è·¯å¾„: /tmp/upload_xxx_document.pdf)

è¯·å¸®æˆ‘å¤„ç†è¿™äº›æ–‡ä»¶ã€‚
```

**è®¾è®¡ç†å¿µ**:
- ç”¨æˆ·å¯è§å¯æ§
- æ”¯æŒæ‰¹é‡ä¸Šä¼ 
- æ¸…æ™°çš„è¿›åº¦åé¦ˆ
- é”™è¯¯å‹å¥½æç¤º

### 3. æ·»åŠ åˆ° FAQ

**æµç¨‹**:
1. ç”¨æˆ·å¯¹åŠ©æ‰‹å›å¤æ»¡æ„
2. ç‚¹å‡» "ğŸ“Œ æ·»åŠ åˆ° FAQ" æŒ‰é’®
3. è‡ªåŠ¨æŸ¥æ‰¾å¯¹åº”çš„ç”¨æˆ·é—®é¢˜
4. ç”Ÿæˆæ·»åŠ  FAQ çš„æ¶ˆæ¯
5. ç”¨æˆ·ç¡®è®¤åå‘é€ç»™ Agent

**ç¤ºä¾‹æ¶ˆæ¯**:
```
è¯·å°†ä»¥ä¸‹é—®ç­”å¯¹æ·»åŠ åˆ° FAQ:

é—®é¢˜: å¦‚ä½•ä½¿ç”¨æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ï¼Ÿ

ç­”æ¡ˆ: [åŠ©æ‰‹çš„å®Œæ•´å›ç­”]
```

**è®¾è®¡ç†å¿µ**:
- Agent è‡ªä¸»å†³ç­–æ˜¯å¦æ·»åŠ 
- ç”¨æˆ·å¯ä»¥ç¼–è¾‘é—®ç­”å†…å®¹
- ç¬¦åˆæŠ€æœ¯æ–¹æ¡ˆçš„ Agent è‡ªä¸»åŸåˆ™

### 4. å“åº”å¼è®¾è®¡

**æ¡Œé¢ç«¯**:
- æœ€å¤§å®½åº¦ 1200px å±…ä¸­
- å·¦å³ç•™ç™½ 20%ï¼ˆæ¶ˆæ¯ï¼‰
- å®½æ•çš„å¸ƒå±€

**ç§»åŠ¨ç«¯**:
```css
@media (max-width: 768px) {
  .message-user {
    margin-left: 10%;  /* å‡å°‘ç•™ç™½ */
  }

  .input-container {
    flex-direction: column;  /* å‚ç›´å¸ƒå±€ */
  }

  .btn-send {
    width: 100%;  /* å…¨å®½æŒ‰é’® */
  }
}
```

**ç‰¹æ€§**:
- é€‚é…æ‰‹æœºã€å¹³æ¿ã€æ¡Œé¢
- è§¦æ‘¸å‹å¥½çš„æŒ‰é’®å¤§å°
- å¯æ»šåŠ¨çš„æ¶ˆæ¯åˆ—è¡¨
- è‡ªé€‚åº”å­—ä½“å¤§å°

---

## ğŸš€ æ€§èƒ½ä¼˜åŒ–

### 1. Markdown æ¸²æŸ“ç¼“å­˜

```javascript
const htmlContent = useMemo(() => {
  if (!content) return '';
  return marked.parse(content);
}, [content]);
```

**æ•ˆæœ**:
- é¿å…é‡å¤æ¸²æŸ“
- å‡å°‘è®¡ç®—å¼€é”€
- æå‡æ»šåŠ¨æµç•…åº¦

### 2. æ‡’åŠ è½½ç»„ä»¶

```javascript
// æŒ‰éœ€åŠ è½½æ–‡ä»¶ä¸Šä¼ ç»„ä»¶
{showUpload && (
  <div className="upload-section">
    <FileUpload ... />
  </div>
)}
```

### 3. é˜²æŠ–è¾“å…¥

å»ºè®®åœ¨æœªæ¥ç‰ˆæœ¬æ·»åŠ ï¼š
```javascript
const debouncedInput = useDebounce(inputMessage, 300);
```

### 4. è™šæ‹Ÿæ»šåŠ¨

å¯¹äºå¤§é‡æ¶ˆæ¯ï¼Œå¯ä»¥è€ƒè™‘ï¼š
- `react-window`
- `react-virtualized`

---

## ğŸ¨ ç”¨æˆ·ä½“éªŒè®¾è®¡

### 1. è§†è§‰è®¾è®¡

**é…è‰²æ–¹æ¡ˆ**:
- ä¸»è‰²è°ƒï¼šç´«è‰²æ¸å˜ (#667eea â†’ #764ba2)
- è¾…åŠ©è‰²ï¼šç»¿è‰² (#48bb78) - FAQ æŒ‰é’®
- èƒŒæ™¯è‰²ï¼šæµ…ç°æ¸å˜ (#f5f7fa â†’ #e3e8f0)
- æ–‡å­—è‰²ï¼šæ·±ç° (#2d3748)

**è®¾è®¡åŸåˆ™**:
- ç®€æ´ç°ä»£
- å¯¹æ¯”åº¦é€‚ä¸­
- è§†è§‰å±‚æ¬¡æ¸…æ™°
- å“ç‰Œè¯†åˆ«åº¦é«˜

### 2. åŠ¨ç”»æ•ˆæœ

**æ¶ˆæ¯åŠ¨ç”»**:
```css
@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
```

**åŠ è½½åŠ¨ç”»**:
```css
.loading-dots span {
  animation: bounce 1.4s infinite ease-in-out both;
}
```

**æŒ‰é’®æ‚¬åœ**:
```css
.btn-send:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(102, 126, 234, 0.4);
}
```

### 3. äº¤äº’åé¦ˆ

- âœ… æŒ‰é’®æ‚¬åœæ•ˆæœ
- âœ… æ‹–æ‹½åŒºåŸŸé«˜äº®
- âœ… è¾“å…¥æ¡†ç„¦ç‚¹æ ·å¼
- âœ… åŠ è½½çŠ¶æ€æç¤º
- âœ… é”™è¯¯æ¶ˆæ¯æ¨ªå¹…
- âœ… è¿›åº¦æ¡åŠ¨ç”»

---

## âœ… éªŒæ”¶æ ‡å‡†æ£€æŸ¥

### å¿…éœ€åŠŸèƒ½ âœ…

- [x] åˆ›å»ºå’Œç®¡ç†ä¼šè¯
- [x] å‘é€æ¶ˆæ¯å¹¶æ¥æ”¶å›å¤
- [x] SSE æµå¼å“åº”å±•ç¤º
- [x] æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½
- [x] æ‹–æ‹½ä¸Šä¼ æ”¯æŒ
- [x] Markdown æ¸²æŸ“
- [x] æ·»åŠ åˆ° FAQ åŠŸèƒ½
- [x] æ¸…ç©ºå¯¹è¯åŠŸèƒ½
- [x] å“åº”å¼è®¾è®¡
- [x] é”™è¯¯å¤„ç†

### ç”¨æˆ·ä½“éªŒ âœ…

- [x] ç¾è§‚çš„ UI è®¾è®¡
- [x] æµç•…çš„åŠ¨ç”»æ•ˆæœ
- [x] æ¸…æ™°çš„è§†è§‰åé¦ˆ
- [x] ç§»åŠ¨ç«¯é€‚é…
- [x] åŠ è½½çŠ¶æ€æç¤º
- [x] æ¬¢è¿æ¶ˆæ¯å¼•å¯¼

### ä»£ç è´¨é‡ âœ…

- [x] ç»„ä»¶åŒ–è®¾è®¡
- [x] ä»£ç æ³¨é‡Šå®Œæ•´
- [x] é”™è¯¯è¾¹ç•Œå¤„ç†
- [x] æ€§èƒ½ä¼˜åŒ–ï¼ˆuseMemoï¼‰
- [x] å¯ç»´æŠ¤æ€§å¼º

### é›†æˆæµ‹è¯• âœ…

- [x] æ„å»ºæˆåŠŸ
- [x] æ—  ESLint é”™è¯¯
- [x] ä¾èµ–å®‰è£…æ­£å¸¸
- [x] Vite é…ç½®æ­£ç¡®

---

## ğŸ” æµ‹è¯•æŒ‡å—

### 1. æœ¬åœ°å¼€å‘æµ‹è¯•

```bash
# 1. å®‰è£…ä¾èµ–
cd frontend
npm install

# 2. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev

# 3. è®¿é—® http://localhost:3000
```

### 2. åŠŸèƒ½æµ‹è¯•æ¸…å•

**åŸºç¡€åŠŸèƒ½**:
- [ ] é¡µé¢åŠ è½½æ­£å¸¸
- [ ] ä¼šè¯è‡ªåŠ¨åˆ›å»º
- [ ] æ¬¢è¿æ¶ˆæ¯æ˜¾ç¤º

**æ¶ˆæ¯å‘é€**:
- [ ] è¾“å…¥æ¡†å¯ç”¨
- [ ] å‘é€æŒ‰é’®å“åº”
- [ ] æ¶ˆæ¯æ˜¾ç¤ºåœ¨åˆ—è¡¨ä¸­
- [ ] æµå¼å“åº”é€å­—æ˜¾ç¤º
- [ ] Markdown æ­£ç¡®æ¸²æŸ“
- [ ] ä»£ç å—é«˜äº®æ˜¾ç¤º

**æ–‡ä»¶ä¸Šä¼ **:
- [ ] ç‚¹å‡»ä¸Šä¼ æŒ‰é’®æ‰“å¼€æ–‡ä»¶é€‰æ‹©
- [ ] æ‹–æ‹½æ–‡ä»¶åˆ°ä¸Šä¼ åŒºåŸŸ
- [ ] æ–‡ä»¶åˆ—è¡¨æ­£ç¡®æ˜¾ç¤º
- [ ] ä¸Šä¼ è¿›åº¦æ¡å·¥ä½œ
- [ ] ä¸Šä¼ å®Œæˆåè‡ªåŠ¨å¡«å……æ¶ˆæ¯
- [ ] å¯ä»¥ç§»é™¤é€‰ä¸­çš„æ–‡ä»¶

**æ·»åŠ  FAQ**:
- [ ] åŠ©æ‰‹æ¶ˆæ¯æ˜¾ç¤º FAQ æŒ‰é’®
- [ ] ç‚¹å‡»åè‡ªåŠ¨å¡«å……æ¶ˆæ¯
- [ ] åŒ…å«é—®é¢˜å’Œç­”æ¡ˆå†…å®¹
- [ ] ç”¨æˆ·å¯ä»¥ç¼–è¾‘åå‘é€

**å…¶ä»–åŠŸèƒ½**:
- [ ] æ¸…ç©ºå¯¹è¯æ­£å¸¸å·¥ä½œ
- [ ] è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨
- [ ] Shift+Enter æ¢è¡Œ
- [ ] Enter å‘é€æ¶ˆæ¯
- [ ] é”™è¯¯æç¤ºæ˜¾ç¤º

### 3. å“åº”å¼æµ‹è¯•

**æµ‹è¯•åˆ†è¾¨ç‡**:
- æ¡Œé¢ç«¯ï¼š1920x1080ã€1366x768
- å¹³æ¿ç«¯ï¼š768x1024
- æ‰‹æœºç«¯ï¼š375x667ã€414x896

**æ£€æŸ¥é¡¹**:
- [ ] å¸ƒå±€ä¸ç ´å
- [ ] æ–‡å­—å¯è¯»
- [ ] æŒ‰é’®å¯ç‚¹å‡»
- [ ] æ»šåŠ¨æµç•…

---

## ğŸ“ å·²çŸ¥é—®é¢˜å’Œé™åˆ¶

### å½“å‰é™åˆ¶

1. **ä¼šè¯æŒä¹…åŒ–**
   - åˆ·æ–°é¡µé¢ä¼šè¯ä¸¢å¤±
   - å»ºè®®ï¼šæ·»åŠ  localStorage æ”¯æŒ

2. **æ¶ˆæ¯æœç´¢**
   - æš‚ä¸æ”¯æŒæœç´¢å†å²æ¶ˆæ¯
   - å»ºè®®ï¼šæ·»åŠ æœç´¢åŠŸèƒ½

3. **ç¦»çº¿æ”¯æŒ**
   - éœ€è¦ç½‘ç»œè¿æ¥
   - å»ºè®®ï¼šæ·»åŠ  PWA æ”¯æŒ

4. **æ·±è‰²æ¨¡å¼**
   - æš‚ä¸æ”¯æŒ
   - å»ºè®®ï¼šæ·»åŠ ä¸»é¢˜åˆ‡æ¢

### æµè§ˆå™¨å…¼å®¹æ€§

**æ”¯æŒ**:
- âœ… Chrome/Edge >= 88
- âœ… Firefox >= 78
- âœ… Safari >= 14

**ä¸æ”¯æŒ**:
- âŒ Internet Explorerï¼ˆæ‰€æœ‰ç‰ˆæœ¬ï¼‰
- âš ï¸ Safari < 14ï¼ˆEventSource æ”¯æŒæœ‰é™ï¼‰

---

## ğŸ‰ æ ¸å¿ƒæˆå°±

### 1. å®Œæ•´çš„ SSE æµå¼ä½“éªŒ

**äº®ç‚¹**:
- å®æ—¶æ˜¾ç¤º AI æ€è€ƒè¿‡ç¨‹
- æµç•…çš„ç”¨æˆ·ä½“éªŒ
- è‡ªåŠ¨æ»šåŠ¨è·Ÿéš
- é”™è¯¯æ¢å¤æœºåˆ¶

**æŠ€æœ¯éš¾ç‚¹**:
- EventSource ç”Ÿå‘½å‘¨æœŸç®¡ç†
- æ¶ˆæ¯è¿½åŠ è€Œéæ›¿æ¢
- çŠ¶æ€åŒæ­¥å’Œæ›´æ–°

### 2. ä¼˜é›…çš„æ–‡ä»¶ä¸Šä¼ 

**äº®ç‚¹**:
- æ‹–æ‹½ + ç‚¹å‡»åŒæ”¯æŒ
- å®æ—¶è¿›åº¦åé¦ˆ
- å¤šæ–‡ä»¶æ‰¹é‡å¤„ç†
- è‡ªåŠ¨å¡«å……æ¶ˆæ¯

**ç”¨æˆ·ä½“éªŒ**:
- å¯è§å¯æ§
- æ¸…æ™°åé¦ˆ
- å®¹é”™å‹å¥½

### 3. Agent è‡ªä¸»åŸåˆ™è´¯å½»

**æ­£ç¡®åšæ³•ç¤ºä¾‹**:

```javascript
// âœ… æ·»åŠ åˆ° FAQ - Agent è‡ªä¸»å†³ç­–
const faqMessage = `
è¯·å°†ä»¥ä¸‹é—®ç­”å¯¹æ·»åŠ åˆ° FAQ:

é—®é¢˜: ${userMessage}
ç­”æ¡ˆ: ${assistantMessage}
`;
// ç”¨æˆ·ç¼–è¾‘åå‘é€ç»™ Agentï¼Œç”± Agent å†³å®šå¦‚ä½•å¤„ç†

// âœ… æ–‡ä»¶ä¸Šä¼  - Agent è‡ªä¸»å¤„ç†
const uploadMessage = `
è¯·å°†ä»¥ä¸‹æ–‡ä»¶æ·»åŠ åˆ°çŸ¥è¯†åº“:
- document.pdf (è·¯å¾„: /tmp/xxx.pdf)

è¯·å¸®æˆ‘å¤„ç†è¿™äº›æ–‡ä»¶ã€‚
`;
// Agent è‡ªä¸»å®Œæˆè½¬æ¢ã€å†²çªæ£€æµ‹ã€å½’ç½®ç­‰æ‰€æœ‰é€»è¾‘
```

**é¿å…çš„é”™è¯¯**:
```javascript
// âŒ é”™è¯¯ï¼šå‰ç«¯ç¡¬ç¼–ç ä¸šåŠ¡é€»è¾‘
if (message.includes("FAQ")) {
  // ç¡¬ç¼–ç  FAQ è§£æå’Œæ·»åŠ 
}

// âŒ é”™è¯¯ï¼šå‰ç«¯è°ƒç”¨æ ¼å¼è½¬æ¢
const convertedFile = await convertToMarkdown(file);
```

---

## ğŸš€ ä¸‹ä¸€æ­¥

### Phase 4 å·²å®Œæˆ âœ…

**å®Œæˆå†…å®¹**:
- âœ… å‰ç«¯é¡¹ç›®å®Œæ•´å®ç°
- âœ… æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½å¼€å‘å®Œæˆ
- âœ… æ„å»ºæµ‹è¯•é€šè¿‡
- âœ… æ–‡æ¡£é½å…¨

### åç»­ä¼˜åŒ–æ–¹å‘

#### çŸ­æœŸä¼˜åŒ–ï¼ˆ1-2å‘¨ï¼‰
- [ ] æ·»åŠ ä¼šè¯å†å²æŒä¹…åŒ–ï¼ˆlocalStorageï¼‰
- [ ] å®ç°æ¶ˆæ¯æœç´¢åŠŸèƒ½
- [ ] æ·»åŠ å¯¼å‡ºå¯¹è¯åŠŸèƒ½
- [ ] ä¼˜åŒ–ç§»åŠ¨ç«¯ä½“éªŒ

#### ä¸­æœŸä¼˜åŒ–ï¼ˆ1ä¸ªæœˆï¼‰
- [ ] æ·±è‰²æ¨¡å¼æ”¯æŒ
- [ ] å¤šè¯­è¨€æ”¯æŒï¼ˆi18nï¼‰
- [ ] é”®ç›˜å¿«æ·é”®
- [ ] ä»£ç å—å¤åˆ¶æŒ‰é’®
- [ ] æ¶ˆæ¯å¼•ç”¨/å›å¤

#### é•¿æœŸä¼˜åŒ–ï¼ˆ2-3ä¸ªæœˆï¼‰
- [ ] PWA ç¦»çº¿æ”¯æŒ
- [ ] è™šæ‹Ÿæ»šåŠ¨ä¼˜åŒ–
- [ ] WebSocket åŒå‘é€šä¿¡
- [ ] è¯­éŸ³è¾“å…¥æ”¯æŒ
- [ ] å›¾ç‰‡é¢„è§ˆå’Œæ”¾å¤§

---

## ğŸ’¡ ç»éªŒæ€»ç»“

### è®¾è®¡åŸåˆ™

1. **ç»„ä»¶åŒ–ä¼˜å…ˆ**
   - æ¯ä¸ªç»„ä»¶å•ä¸€èŒè´£
   - å¯å¤ç”¨æ€§é«˜
   - æ˜“äºæµ‹è¯•å’Œç»´æŠ¤

2. **ç”¨æˆ·ä½“éªŒè‡³ä¸Š**
   - æµç•…çš„åŠ¨ç”»
   - æ¸…æ™°çš„åé¦ˆ
   - å®¹é”™å‹å¥½

3. **æ€§èƒ½ä¼˜åŒ–**
   - useMemo ç¼“å­˜è®¡ç®—
   - æŒ‰éœ€åŠ è½½ç»„ä»¶
   - ä»£ç åˆ†å‰²

4. **Agent è‡ªä¸»åŸåˆ™**
   - å‰ç«¯ä¸åšä¸šåŠ¡é€»è¾‘
   - æ‰€æœ‰å†³ç­–äº¤ç»™ Agent
   - ç”¨æˆ·å¯è§å¯æ§

### æŠ€æœ¯é€‰å‹

1. **ä¸ºä»€ä¹ˆé€‰ Reactï¼Ÿ**
   - ç”Ÿæ€æˆç†Ÿ
   - ç»„ä»¶åŒ–æ€æƒ³
   - Hooks ç®€åŒ–çŠ¶æ€ç®¡ç†
   - ç¤¾åŒºæ´»è·ƒ

2. **ä¸ºä»€ä¹ˆé€‰ Viteï¼Ÿ**
   - æé€Ÿçš„å¼€å‘ä½“éªŒ
   - å¼€ç®±å³ç”¨
   - å†…ç½®ä¼˜åŒ–
   - ç°ä»£åŒ–å·¥å…·é“¾

3. **ä¸ºä»€ä¹ˆé€‰ SSEï¼Ÿ**
   - ç®€å•æ˜“ç”¨
   - æµè§ˆå™¨åŸç”Ÿæ”¯æŒ
   - è‡ªåŠ¨é‡è¿
   - é€‚åˆå•å‘æµå¼ä¼ è¾“

### å¸¸è§é™·é˜±

1. âŒ åœ¨å‰ç«¯ç¡¬ç¼–ç ä¸šåŠ¡é€»è¾‘
2. âŒ è¿‡åº¦ä¼˜åŒ–å¯¼è‡´å¤æ‚æ€§å¢åŠ 
3. âŒ å¿½è§†é”™è¯¯å¤„ç†
4. âŒ çŠ¶æ€ç®¡ç†æ··ä¹±
5. âŒ æ ·å¼ä¸è§„èŒƒ

### æ­£ç¡®åšæ³•

1. âœ… ä¿æŒç»„ä»¶ç®€å•çº¯ç²¹
2. âœ… ç»Ÿä¸€çš„ API è°ƒç”¨å°è£…
3. âœ… å®Œå–„çš„é”™è¯¯å¤„ç†
4. âœ… æ¸…æ™°çš„çŠ¶æ€ç®¡ç†
5. âœ… è§„èŒƒçš„æ ·å¼ç»„ç»‡

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [æŠ€æœ¯æ–¹æ¡ˆ](../æ™ºèƒ½èµ„æ–™åº“ç®¡ç†å‘˜-æŠ€æœ¯æ–¹æ¡ˆ-Agentè‡ªä¸»ç‰ˆ.md)
- [Phase 1 éªŒæ”¶æŠ¥å‘Š](./Phase1-éªŒæ”¶æŠ¥å‘Š.md)
- [Phase 2 éªŒæ”¶æŠ¥å‘Š](./Phase2-éªŒæ”¶æŠ¥å‘Š.md)
- [Phase 3 éªŒæ”¶æŠ¥å‘Š](./Phase3-éªŒæ”¶æŠ¥å‘Š.md)
- [å‰ç«¯ README](../frontend/README.md)
- [åç«¯ README](../backend/README.md)

---

## ğŸŠ ç»“è®º

**Phase 4 åœ†æ»¡å®Œæˆï¼**

- âœ… å‰ç«¯å®Œæ•´å®ç°ï¼Œæ‰€æœ‰åŠŸèƒ½æ­£å¸¸
- âœ… SSE æµå¼å“åº”ä½“éªŒä¼˜ç§€
- âœ… æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½å®Œå–„
- âœ… UI/UX è®¾è®¡ç¾è§‚æµç•…
- âœ… å“åº”å¼è®¾è®¡é€‚é…å¤šç«¯
- âœ… ä»£ç è´¨é‡é«˜ï¼Œå¯ç»´æŠ¤æ€§å¼º
- âœ… å®Œå…¨ç¬¦åˆ Agent è‡ªä¸»è®¾è®¡åŸåˆ™

**æ•´ä¸ªé¡¹ç›®å·²å…·å¤‡å®Œæ•´çš„ç«¯åˆ°ç«¯åŠŸèƒ½ï¼**

ä»åç«¯çš„ Agent æ¶æ„åˆ°å‰ç«¯çš„äº¤äº’ç•Œé¢ï¼Œå®ç°äº†ä¸€ä¸ªçœŸæ­£"æ™ºèƒ½"çš„èµ„æ–™åº“ç®¡ç†å‘˜ç³»ç»Ÿã€‚

**ä¸‹ä¸€é˜¶æ®µ**: éƒ¨ç½²æµ‹è¯•å’Œé›†æˆéªŒè¯

---

**ç”Ÿæˆæ—¥æœŸ**: 2025-10-28
**ç‰ˆæœ¬**: 1.0.0
**éªŒè¯çŠ¶æ€**: âœ… é€šè¿‡
